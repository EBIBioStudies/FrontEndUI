<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <index id="experiments" location="${sys:java.io.tmpdir}/index" defaultAnalyzer="uk.ac.ebi.arrayexpress.utils.search.AttributeFieldAnalyzer">
        <document path="/experiments/experiment" defaultField="keywords">
            <field name="keywords" type="string" path="string-join(.//text(), ' ')" analyze="true" analyzer="uk.ac.ebi.arrayexpress.utils.search.ExperimentTextAnalyzer" store="false" escape="false"/>
            <field name="accession" title="by Accession" type="string" path="accession | secondaryaccession" analyze="true" store="false" escape="false"/>
            <field name="date" title="by Release Date" type="string" path="releasedate" analyze="true" store="false" escape="false"/>
            <field name="species" title="by Species" type="string" path="species" analyze="true" store="false" escape="false"/>
            <field name="array" title="by Array" type="string" path="arraydesign/id | arraydesign/accession | arraydesign/name" analyze="true" store="false" escape="false"/>
            <field name="exptype" title="by Experiment Type" type="string" path="experimenttype" analyze="true" store="false" escape="false" forcePhraseQuery="true"/>
            <field name="expdesign" title="by Experiment Design" type="string" path="experimentdesign" analyze="true" store="false" escape="false"/>
            <field name="ef" title="by Experimental Factor" type="string" path="experimentalfactor/name" analyze="true" store="false" escape="false"/>
            <field name="efv" title="by Experimental Factor Value" type="string" path="experimentalfactor/value" analyze="true" store="false" escape="false"/>
            <field name="sa" title="by Sample Attribute Value" type="string" path="sampleattribute/value" analyze="true" store="false" escape="true"/>
            <field name="pmid" title="by PubMed ID" type="string" path="bibliography/accession" analyze="false" store="false" escape="false"/>
            <field name="userid" type="string" path="user" analyze="false" store="false" escape="false"/>
            <field name="gxa" title="only experiments loaded in Gene Expression Atlas" type="string" path="@loadedinatlas" analyze="false" store="false" escape="false"/>
            <field name="directsub" title="only ArrayExpress direct submissions" type="string" path="if (not(contains(accession, '-GEOD-'))) then 'true' else 'false'" analyze="false" store="false" escape="false"/>
            <!-- numeric fields -->
            <field name="assaycount" title="Number of Assays" type="integer" path="(if (assays castable as xs:integer) then assays else 0) cast as xs:integer" />
            <field name="samplecount" title="Number of Samples" type="integer" path="(if (samples castable as xs:integer) then samples else 0) cast as xs:integer" />
            <field name="rawcount" type="integer" path="(if (rawdatafiles castable as xs:integer) then rawdatafiles else 0) cast as xs:integer" />
            <field name="fgemcount" type="integer" path="(if (fgemdatafiles castable as xs:integer) then fgemdatafiles else 0) cast as xs:integer" />
            <field name="efcount"  title="Number of Experimental Factors" type="integer" path="count(distinct-values(experimentalfactor/name, 'http://saxon.sf.net/collation?ignore-case=yes'))" />
            <field name="sacount" title="Number of Sample Attributes" type="integer" path="count(distinct-values(sampleattribute/category, 'http://saxon.sf.net/collation?ignore-case=yes'))" />
            <field name="miamescore" title="MIAME Score" type="integer" path="(if (miamescores/overallscore castable as xs:integer) then miamescores/overallscore else 0) cast as xs:integer" />
        </document>
    </index>
    <index id="protocols">
        <document path="/protocols/protocol">
            <field name="keywords" path="string-join(.//text(), ' ')" analyze="true" store="false" />
        </document>
    </index>
    <index id="arrays">
        <document path="/arrays/array">
            <field name="keywords" path="string-join(.//text(), ' ')" analyze="true" store="false" />
        </document>
    </index>
</configuration>