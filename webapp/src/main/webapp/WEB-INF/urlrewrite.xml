<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE urlrewrite
        PUBLIC "-//tuckey.org//DTD UrlRewrite 3.0//EN"
        "http://tuckey.org/res/dtds/urlrewrite3.0.dtd">

<urlrewrite>
    <!-- show a list of experiments for googlebots -->
    <rule>
        <from>^/browse\.html$</from>
        <condition name="user-agent">googlebot.*</condition>
        <to type="forward">/servlets/query/browse-experiments-noajax/html</to>
    </rule>

    <!-- experiment by accession page -->
    <rule>
        <from>^/experiments/([eE]-\w{4}-\d+)$</from>
        <to type="forward">/servlets/query/browse-experiment/html?accession=$1</to>
    </rule>

    <!-- available files by accession page -->
    <rule>
        <from>^/files/([aAeE]-\w{4}-\d+)/?$</from>
        <to type="forward">/servlets/query/browse-files/html?accession=$1</to>
    </rule>
    <rule>
        <from>^/files/([aAeE]-\w{4}-\d+)/index.html$</from>
        <to type="forward">/servlets/query/browse-files/html?accession=$1</to>
    </rule>
    <!-- files download support -->
    <rule>
        <from>^/files/([aAeE]-\w{4}-\d+)/(.+)$</from>
        <to type="forward">/servlets/download/$1/$2</to>
    </rule>
    <!-- legacy download support -->
    <rule>
        <from>^/download/(.+)$</from>
        <to type="forward">/servlets/download/$1</to>
    </rule>
    <!-- rss feeds support, old scheme -->
    <rule>
        <from>^/rss/experiments$</from>
        <to type="forward">/servlets/query/experiments-rss/xml?queryversion=1</to>
    </rule>

    <!-- rss feeds support, current scheme -->
    <rule>
        <from>^/rss/v2/experiments$</from>
        <to type="forward">/servlets/query/experiments-rss/xml</to>
    </rule>

    <!-- rest api support -->
    <rule>
        <from>^/xml/experiments$</from>
        <to type="forward">/servlets/query/experiments/xml?queryversion=1</to>
    </rule>
    <rule>
        <from>^/xml/experiments/([eE]-\w{4}-\d+)$</from>
        <to type="forward">/servlets/query/experiments/xml?accession=$1</to>
    </rule>
    <rule>
        <from>^/xml/experiments/(.*)$</from>
        <to type="forward">/servlets/query/experiments/xml?queryversion=1&amp;keywords=$1</to>
    </rule>
    <rule>
        <from>^/xml/files$</from>
        <to type="forward">/servlets/query/files/xml?queryversion=1</to>
    </rule>
    <rule>
        <from>^/xml/files/([eE]-\w{4}-\d+)$</from>
        <to type="forward">/servlets/query/files/xml?accession=$1</to>
    </rule>
    <rule>
        <from>^/xml/files/(.*)$</from>
        <to type="forward">/servlets/query/files/xml?queryversion=1&amp;keywords=$1</to>
    </rule>

    <!-- rest api v2 support -->
    <rule>
        <from>^/xml/v2/experiments$</from>
        <to type="forward">/servlets/query/experiments/xml</to>
    </rule>
    <rule>
        <from>^/xml/v2/experiments/([eE]-\w{4}-\d+)$</from>
        <to type="forward">/servlets/query/experiments/xml?accession=$1</to>
    </rule>
    <rule>
        <from>^/xml/v2/experiments/(.*)$</from>
        <to type="forward">/servlets/query/experiments/xml?keywords=$1</to>
    </rule>
    <rule>
        <from>^/xml/v2/files$</from>
        <to type="forward">/servlets/query/files/xml</to>
    </rule>
    <rule>
        <from>^/xml/v2/files/([eE]-\w{4}-\d+)$</from>
        <to type="forward">/servlets/query/files/xml?accession=$1</to>
    </rule>
    <rule>
        <from>^/xml/v2/files/(.*)$</from>
        <to type="forward">/servlets/query/files/xml?keywords=$1</to>
    </rule>

    <!-- json-flavored rest api -->
    <rule>
        <from>^/json/v2/experiments$</from>
        <to type="forward">/servlets/query/experiments/json</to>
    </rule>
    <rule>
        <from>^/json/v2/experiments/([eE]-\w{4}-\d+)$</from>
        <to type="forward">/servlets/query/experiments/json?accession=$1</to>
    </rule>
    <rule>
        <from>^/json/v2/experiments/(.*)$</from>
        <to type="forward">/servlets/query/experiments/json?keywords=$1</to>
    </rule>

    <!-- proxy calls to json efo api for nils -->
    <rule>
        <from>^/json/v2/efotree$</from>
        <to type="forward">/servlets/proxy/http://foo.ebi.ac.uk:8180/microarray-as/ae/json/v2/efotree</to>
    </rule>
    <rule>
        <from>^/json/v2/efodict$</from>
        <to type="forward">/servlets/proxy/http://foo.ebi.ac.uk:8180/microarray-as/ae/json/v2/efodict</to>
    </rule>

    <!-- ebeye export -->
    <rule>
        <from>^/ArrayExpress-Experiments-EBeye.xml$</from>
        <to type="forward">/servlets/query/experiments-ebeye/xml</to>
    </rule>

    <!-- search results export in tab format -->
    <rule>
        <from>^/ArrayExpress-Experiments\.xls$</from>
        <to type="forward">/servlets/query/experiments/xls</to>
    </rule>
    <rule>
        <from>^/ArrayExpress-Experiments\.txt$</from>
        <to type="forward">/servlets/query/experiments/tab</to>
    </rule>

    <!-- print-friendly layout for the experiments -->
    <rule>
        <from>^/browse\.printer\.html$</from>
        <to type="forward">/servlets/query/browse-experiments-printer/html</to>
    </rule>

    <!-- redirects to some pages at www.ebi.ac.uk (via proxy servlet) -->
    <rule>
        <from>^/ae-news.xml</from>
        <to type="forward">/servlets/proxy/http://www.ebi.ac.uk/microarray-srv/ae/ae-main-news.xml</to>
    </rule>
    <rule>
        <from>^/ae-links.xml</from>
        <to type="forward">/servlets/proxy/http://www.ebi.ac.uk/microarray-srv/ae/ae-main-links.xml</to>
    </rule>
    <rule>
        <from>^/atlas_list-species.html</from>
        <to type="forward">/servlets/proxy/http://www.ebi.ac.uk/gxa/list-species.jsp</to>
    </rule>
    <rule>
        <from>^/atlas_stats.txt</from>
        <to type="forward">/servlets/proxy/http://www.ebi.ac.uk/gxa/stats.jsp</to>
    </rule>

    <!-- hiding browse helpers behind innocent names -->
    <rule>
        <from>^/browse-table.html</from>
        <to type="forward">/servlets/query/browse-experiments/html</to>
    </rule>
    <rule>
        <from>^/species-list.html</from>
        <to type="forward">/servlets/query/species-select/html</to>
    </rule>
    <rule>
        <from>^/arrays-list.html</from>
        <to type="forward">/servlets/query/arrays-select/html</to>
    </rule>
    <rule>
        <from>^/expdesign-list.html</from>
        <to type="forward">/servlets/lookup/expdesign</to>
    </rule>
    <rule>
        <from>^/exptech-list.html</from>
        <to type="forward">/servlets/lookup/exptech</to>
    </rule>
    <rule>
        <from>^/keywords.txt</from>
        <to type="forward">/servlets/lookup/keywords</to>
    </rule>
    <rule>
        <from>^/efotree.txt</from>
        <to type="forward">/servlets/lookup/efotree</to>
    </rule>
    <rule>
        <from>^/ae-stats.xml</from>
        <to type="forward">/servlets/query/stats</to>
    </rule>
    <rule>
        <from>^/verify-login.txt</from>
        <to type="forward">/servlets/control/verify-login</to>
    </rule>

    <!-- control links -->
    <rule>
        <from>^/reload-atlas-info</from>
        <to type="forward">/servlets/control/reload-atlas-info</to>
    </rule>
    <rule>
        <from>^/reload-xml</from>
        <to type="forward">/servlets/control/reload-xml</to>
    </rule>
    <rule>
        <from>^/reload-xml/(.+)</from>
        <to type="forward">/servlets/control/reload-xml/$1</to>
    </rule>
    <rule>
        <from>^/rescan-ftp</from>
        <to type="forward">/servlets/control/rescan-files</to>
    </rule>
    <rule>
        <from>^/rescan-ftp/(.+)</from>
        <to type="forward">/servlets/control/rescan-files/$1</to>
    </rule>

    <!-- experimental noajax browse interface -->
    <rule>
        <from>^/browse-noajax.html$</from>
        <to type="forward">/servlets/query/browse-experiments-noajax/html?cache=true</to>
    </rule>

    <!-- legacy links -->
    <rule>
        <from>^/query/result$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray-as/aer/result?%{query-string}</to>
    </rule>

    <rule>
        <from>^/query/(.+)$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray-as/aer/$1?%{query-string}</to>
    </rule>

    <rule>
        <from>^/query/?$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/arrayexpress</to>
    </rule>

    <rule>
        <from>^/genes/uniprot/(.*)$</from>
        <to type="permanent-redirect">${interface.application.link.atlas.base.url}/gene?gid=$1</to>
    </rule>
    <rule>
        <from>^/genes/ensembl/(.*)$</from>
        <to type="permanent-redirect">${interface.application.link.atlas.base.url}/gene?gid=$1</to>
    </rule>
    <rule>
        <from>^/genes/any/(.*)$</from>
        <to type="permanent-redirect">${interface.application.link.atlas.base.url}/gene?gid=$1</to>
    </rule>
    <!-- ArrayExpress old link redirects  -->
    <rule>
        <from>^/news_archive.html$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray/General/News/news.html</to>
    </rule>

    <rule>
        <from>^/Help/faq.html$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray/doc/help/faq.html</to>
    </rule>

    <rule>
        <from>^/Help/stats/?$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray/doc/stats/</to>
    </rule>

    <rule>
        <from>^/Help/index.html$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray/doc/help/ae_help.html</to>
    </rule>

    <rule>
        <from>^/Help/?$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray/doc/help/ae_help.html</to>
    </rule>

    <rule>
        <from>^/Implementation/?$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray/doc/software/ae_index.html</to>
    </rule>

    <rule>
        <from>^/Schema/?$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray/doc/software/ae_index.html</to>
    </rule>

    <rule>
        <from>^/Standards/?$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray/doc/standards.html</to>
    </rule>

    <rule>
        <from>^/Submissions/?$</from>
        <to type="permanent-redirect">http://www.ebi.ac.uk/microarray/submissions.html</to>
    </rule>

</urlrewrite>
